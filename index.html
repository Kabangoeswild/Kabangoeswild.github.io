<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AR Video mit Einzelmarkern</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/ar.js/2.2.1/aframe/build/aframe-ar.min.js"></script>
    <style>
      video {
        display: none;
        position: fixed;
        bottom: 10px;
        left: 10px;
        width: 300px;
        border: 2px solid #fff;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.5);
      }
    </style>
  </head>

  <body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
      <!-- Marker Hiro -->
      <a-marker id="hiro-marker" type="pattern" preset="hiro">
        <a-box position="0 0.5 0" material="color: red;"></a-box>
      </a-marker>

      <!-- Marker Kanji -->
      <a-marker id="kanji-marker" type="pattern" preset="kanji">
        <a-sphere position="0 0.5 0" material="color: blue;"></a-sphere>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>

    <!-- Videos im DOM -->
    <video id="video-hiro" src="video1.mp4" muted autoplay loop playsinline></video>
    <video id="video-kanji" src="video2.mp4" muted autoplay loop playsinline></video>

    <script>
      window.addEventListener('load', () => {
        const markers = {
          hiro: document.querySelector('#hiro-marker'),
          kanji: document.querySelector('#kanji-marker')
        };

        const videos = {
          hiro: document.getElementById('video-hiro'),
          kanji: document.getElementById('video-kanji')
        };

        // Videos vorbereiten
        Object.values(videos).forEach(video => {
          if (video.readyState >= 3) video.play();
          else video.addEventListener('canplay', () => video.play(), { once: true });
          video.style.display = 'none';
        });

        function update() {
          Object.entries(markers).forEach(([name, marker]) => {
            const video = videos[name];
            if (!video) return;

            if (marker.object3D.visible) {
              video.style.display = 'block';

              const pos = new THREE.Vector3();
              marker.object3D.getWorldPosition(pos);
              console.log(`Marker "${name}" sichtbar:`, pos);

              const rot = marker.object3D.rotation;
              console.log(`Rotation ${name}: x=${THREE.MathUtils.radToDeg(rot.x).toFixed(1)}°, y=${THREE.MathUtils.radToDeg(rot.y).toFixed(1)}°`);
            } else {
              video.style.display = 'none';
            }
          });
        }

        setInterval(update, 100);
      });
    </script>
  </body>
</html>

