<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AR.js mit Hiro und Kanji Marker</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/jeromeetienne/ar.js/1.7.2/aframe/build/aframe-ar.min.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
  <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">

    <!-- Marker Hiro -->
    <a-marker preset="hiro">
      <a-video id="markerVideo1" autoplay loop="true" src="#video1" width="3" height="0.75" position="0 -1 -1.5" rotation="-90 0 0"
          material="transparent: true;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo2" autoplay loop="true" src="#video2" width="3" height="0.75" position="0 -1 -1.5" rotation="-30 0 0"
          material="transparent: true;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo3" autoplay loop="true" src="#video3" width="3" height="0.75" position="0 -1 -1.5" rotation="0 90 0"
          material="transparent: true; opacity: 0.8;" visible="true"></a-video>
      <a-video id="markerVideo4" autoplay loop="true" src="#video4" width="3" height="0.75" position="0 -1 -1.5" rotation="-60 0 0"
          material="transparent: true;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo5" autoplay loop="true" src="#video5" width="3" height="0.75" position="-0.5 -1 -1.5" rotation="0 90 0"
          material="transparent: true; opacity: 0.8;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo6" autoplay loop="true" src="#video6" width="3" height="0.75" position="0.5 -1 -1.5" rotation="0 90 0"
          material="transparent: true; opacity: 0.8;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo7" autoplay loop="true" src="#video7" width="3" height="0.75" position="0 -1 -1.5" rotation="0 30 0"
          material="transparent: true; opacity: 0.8;  depthTest: false; blending: normal;" visible="true"></a-video>
  </a-marker>

    <!-- Marker Kanji -->
    <a-marker preset="kanji">
      <a-video id="markerVideo1" autoplay loop="true" src="#video1" width="3" height="0.75" position="0 -1 -1.5" rotation="-90 0 0"
          material="transparent: true;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo2" autoplay loop="true" src="#video2" width="3" height="0.75" position="0 -1 -1.5" rotation="-30 0 0"
          material="transparent: true;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo3" autoplay loop="true" src="#video3" width="3" height="0.75" position="0 -1 -1.5" rotation="0 90 0"
          material="transparent: true; opacity: 0.8;" visible="true"></a-video>
      <a-video id="markerVideo4" autoplay loop="true" src="#video4" width="3" height="0.75" position="0 -1 -1.5" rotation="-60 0 0"
          material="transparent: true;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo5" autoplay loop="true" src="#video5" width="3" height="0.75" position="-0.5 -1 -1.5" rotation="0 90 0"
          material="transparent: true; opacity: 0.8;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo6" autoplay loop="true" src="#video6" width="3" height="0.75" position="0.5 -1 -1.5" rotation="0 90 0"
          material="transparent: true; opacity: 0.8;  depthTest: false; blending: normal;" visible="true"></a-video>
      <a-video id="markerVideo7" autoplay loop="true" src="#video7" width="3" height="0.75" position="0 -1 -1.5" rotation="0 30 0"
          material="transparent: true; opacity: 0.8;  depthTest: false; blending: normal;" visible="true"></a-video>
  </a-marker>

    <!-- Kamera -->
    <a-entity camera></a-entity>

    <!-- Assets -->
    <a-assets>
      <video id="video1" src="xz-notencoded_DSQzQjVL.mp4" crossorigin="anonymous" preload="auto" loop muted playsinline></video>
      <video id="video2" src="xz-rot-x-30-deg_Dqejoe8d.mp4" crossorigin="anonymous" preload="auto" loop muted playsinline></video>
      <video id="video3" src="yz-x_rukE9moh.mp4" crossorigin="anonymous" preload="auto" loop muted playsinline></video>
      <video id="video4" src="xz-rot-x-60-deg_LP2UAxuj.mp4" crossorigin="anonymous" preload="auto" loop muted playsinline></video>
      <video id="video5" src="yz-x-035_bQDTO1Mq.mp4" crossorigin="anonymous" preload="auto" loop muted playsinline></video>
      <video id="video6" src="yz-x0,35_ttixT4aA.mp4" crossorigin="anonymous" preload="auto" loop muted playsinline></video>
      <video id="video7" src="xz-rot-z-30-deg_VQ1Otf3Z.mp4" crossorigin="anonymous" preload="auto" loop muted playsinline></video>
  </a-assets>
  </a-scene>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const markers = [
        {
          name: 'hiro',
          el: document.querySelector('#marker-hiro'),
          vids: {
            v1: document.querySelector('#video1-hiro'),
            v2: document.querySelector('#video2-hiro'),
            v3: document.querySelector('#video3-hiro'),
            v4: document.querySelector('#video4-hiro'),
            v5: document.querySelector('#video5-hiro'),
            v6: document.querySelector('#video6-hiro')
          }
        },
        {
          name: 'kanji',
          el: document.querySelector('#marker-kanji'),
          vids: {
            v1: document.querySelector('#video1-kanji'),
            v2: document.querySelector('#video2-kanji'),
            v3: document.querySelector('#video3-kanji'),
            v4: document.querySelector('#video4-kanji'),
            v5: document.querySelector('#video5-kanji'),
            v6: document.querySelector('#video6-kanji')
          }
        }
      ];

      function updateVideos(markerObj) {
        const marker = markerObj.el;
        const vids = markerObj.vids;
        const camera = document.querySelector('[camera]');

        if (!marker.object3D.visible) return;

        const markerPos = new THREE.Vector3();
        const camPos = new THREE.Vector3();
        marker.object3D.getWorldPosition(markerPos);
        camera.object3D.getWorldPosition(camPos);

        const distance = markerPos.distanceTo(camPos);
        const rotationX = THREE.MathUtils.radToDeg(marker.object3D.rotation.x);
        const rotationY = THREE.MathUtils.radToDeg(marker.object3D.rotation.y);

        // Video 1 & 2: Opacity abhÃ¤ngig von Rotation X & Y
        if (rotationX > 60 && rotationY > -20 && rotationY < 20) {
          vids.v1.setAttribute('material', 'opacity', 1);
        } else {
          vids.v1.setAttribute('material', 'opacity', 0.2);
        }

        if (rotationX > 60 && rotationY > -20 && rotationY < 20) {
          vids.v2.setAttribute('material', 'opacity', 1);
        } else {
          vids.v2.setAttribute('material', 'opacity', 0.2);
        }

        // Video 3: fade out wenn Distanz < 2.5, fade in wenn Distanz > 2.5
        if (distance < 2.5) {
          vids.v3.setAttribute('material', 'opacity', 0);
        } else {
          vids.v3.setAttribute('material', 'opacity', 1);
        }

        vids.v4.setAttribute('material', 'opacity', 1);

        // Video 5 & 6: je nach Rotation Y
        if (rotationY < 0) {
          vids.v5.setAttribute('material', 'opacity', 0.5);
          vids.v6.setAttribute('material', 'opacity', 1);
        } else {
          vids.v5.setAttribute('material', 'opacity', 1);
          vids.v6.setAttribute('material', 'opacity', 0.5);
        }
      }

      setInterval(() => {
        markers.forEach(markerObj => {
          if (markerObj.el.object3D.visible) {
            updateVideos(markerObj);
          }
        });
      }, 100);
    });
  </script>
</body>
</html>
